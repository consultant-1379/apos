# Configuration template file for 99-lde-streaming-messages.conf drop-in.
# 99-lde-streaming-messages.conf will be generated by lde-logm-streaming-parser and placed in /etc/rsyslog.d directory
# <VALUE> will be replaced by real value from parser

# Store messages log to local
$template messages_dest, "<LOG_FILE>"

if (<FILTERS>) then {
#    if ($syslogtag contains ":") then {
#        action(type="omfile" DirCreateMode="0750" FileCreateMode="0640" flushOnTXEnd="on" asyncWriting="on" flushInterval="1" dynaFile="messages_dest" template="CBAFormat_mSec")
#    } else {
#        action(type="omfile" DirCreateMode="0750" FileCreateMode="0640" flushOnTXEnd="on" asyncWriting="on" flushInterval="1" dynaFile="messages_dest" template="CBAFormat_mSec_AddColon")
#    }

    # Do not repeat streaming kernel log
    if ($syslogfacility-text == "kern" or ($app-name == 'kernel' and $syslogfacility-text == 'user')) then {
        *.* stop
    }
    <LOG_FORWARD>
    set $!stream_pri = $pri;
    # Customize msgid field.
    set $!stream_msgid = "<MSGID>";
    <STREAMING>
}

*.* stop

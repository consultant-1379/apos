# Configuration template file for 98-lde-streaming-auth.conf drop-in.
# 98-lde-streaming-auth.conf will be generated by lde-logm-streaming-parser and placed in /etc/rsyslog.d directory
# <VALUE> will be replaced by real value from parser

# Store messages log to local
$template auth_dest, "<LOG_FILE>"

if ($syslogfacility-text == ['auth','authpriv']) then {

    if (<FILTERS>) then {
#        if ($syslogtag contains ":") then {
#            action(type="omfile" DirCreateMode="0750" FileCreateMode="0640" flushOnTXEnd="on" asyncWriting="on" flushInterval="1" dynaFile="auth_dest" template="CBAFormat_mSec")
#        } else {
#            action(type="omfile" DirCreateMode="0750" FileCreateMode="0640" flushOnTXEnd="on" asyncWriting="on" flushInterval="1" dynaFile="auth_dest" template="CBAFormat_mSec_AddColon")
#        }

  call dummy_ruleset
 
   <LOG_FORWARD>
    set $!stream_pri = <FACILITY> * 8 + $syslogseverity;
    # Customize msgid field.
    set $!stream_msgid = "<MSGID>";
    <STREAMING>
}

    *.* stop
}
